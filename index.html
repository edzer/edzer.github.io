<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Meaningful Spatial Statistics: The <code>mss</code> Package</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{Meaningful Spatial Statistics: an introduction}
\usepackage[utf8]{inputenc}
-->

<h1>Meaningful Spatial Statistics: The <code>mss</code> Package</h1>

<p>This vignette introduces an R package for meaningful spatial statistics,</p>

<pre><code class="r">library(mss)
</code></pre>

<p>The package introduces three classes for spatial data: <code>SpatialField</code>
for representing geostatistical data, <code>SpatialEntities</code> for
point patterns, and <code>SpatialAggregation</code> for lattice (areal)
data.</p>

<h2><code>Window</code>: field domain or observation windows</h2>

<p><code>SpatialField</code> and <code>SpatialEntities</code> contain a <code>Window</code>,
representing the domain of the field, or the window of observation
for a point pattern.  </p>

<p>The window class defines an area: </p>

<pre><code class="r">showClass(&quot;Window&quot;)
</code></pre>

<pre><code>## Class &quot;Window&quot; [package &quot;mss&quot;]
## 
## Slots:
##               
## Name:     area
## Class: Spatial
## 
## Extends: &quot;WindowOrNULL&quot;
</code></pre>

<p>The area can be represented either by a grid, as in</p>

<pre><code class="r">library(sp)
demo(meuse, ask = FALSE, echo = FALSE)
w2 = Window(meuse.grid) # note the grid is passed, not the polygons
</code></pre>

<p>or by a polygon or set of polygons, as in</p>

<pre><code class="r">w1 = Window(meuse.area)
</code></pre>

<h2><code>SpatialField</code>: geostatistical data</h2>

<p>SpatialFields represent <em>continuous</em> functions, which over a
domain \(D\) have a value at every <em>point</em> \(s \in D\).</p>

<pre><code class="r">showClass(&quot;SpatialField&quot;)
</code></pre>

<pre><code>## Class &quot;SpatialField&quot; [package &quot;mss&quot;]
## 
## Slots:
##                                                    
## Name:    observations         domain cellsArePoints
## Class:        Spatial   WindowOrNULL        logical
</code></pre>

<h3>Fields from points</h3>

<p>Observations on fields variables are often done on irregular
point locations. Such a field variable is created from a
<code>SpatialPointsDataFrame</code> object:</p>

<pre><code class="r">sf = SpatialField(meuse, meuse.grid)
</code></pre>

<p>where, here, <code>meuse.grid</code> defines the domain for the
field. Alternatively, <em>point observations</em> can be gridded, and
defined as a field by</p>

<pre><code class="r">sf = SpatialField(meuse.grid, meuse.grid, cellsArePoints = TRUE)
</code></pre>

<p>Note that the first argument defines the point observations, and 
the second argument the domain: the first argument is treated as
a (gridded) set of points (grid cell centres), the second as a 
gridded set of areas (cells).</p>

<h3>Fields from grids, grid cells representing constant areas</h3>

<p>We can alternatively assume that each grid cell represents an area
with constant point values. Such a field is defined by:</p>

<pre><code class="r">sf = SpatialField(meuse.grid, meuse.grid, cellsArePoints = FALSE)
</code></pre>

<p>This field is completely known, for every point location. Note
that grid cell values are <em>constant throughout the cell</em>, and are
not conceived as cell aggregate (e.g. average, or otherwise
convoluted) values. For that case, <code>SpatialAggregates</code> are used.</p>

<h3>Fields from lines and polygons</h3>

<p>Sets of points can not only be defined by grid cells, but also
through lines, or polygons. For instance, points on a contour
line could form a sample of a field:</p>

<pre><code class="r">library(maptools)
</code></pre>

<pre><code>## Checking rgeos availability: TRUE
</code></pre>

<pre><code class="r">library(rgeos)
</code></pre>

<pre><code>## rgeos version: 0.3-11, (SVN revision 479)
##  GEOS runtime version: 3.4.2-CAPI-1.8.2 r3921 
##  Linking to sp version: 1.1-0 
##  Polygon checking: TRUE
</code></pre>

<pre><code class="r">cl = ContourLines2SLDF(contourLines(as.image.SpatialGridDataFrame(
  meuse.grid[&quot;dist&quot;])))
proj4string(cl) = CRS(proj4string(meuse.grid))
sf.lines = SpatialField(cl, meuse.grid)
</code></pre>

<p>or, alternatively, as a set of polygons; in this example, a single
polygon with a constant value:</p>

<pre><code class="r">pol = addAttrToGeom(meuse.area, data.frame(value = 3), FALSE)
sf.pol = SpatialField(pol, meuse.area)
</code></pre>

<h2><code>SpatialEntities</code>: point patterns or objects</h2>

<p>The <code>SpatialEntities</code> class can be used to represent objects in a space,
where the <em>window of observation</em> reflects the area for which all
points or objects are available:</p>

<pre><code class="r">showClass(&quot;SpatialEntities&quot;)
</code></pre>

<pre><code>## Class &quot;SpatialEntities&quot; [package &quot;mss&quot;]
## 
## Slots:
##                                 
## Name:  observations       window
## Class:      Spatial WindowOrNULL
</code></pre>

<p>We can create a point pattern e.g. for the sample locations of the <code>meuse</code>
data set:</p>

<pre><code class="r">pts = geometry(meuse)
se.pts = SpatialEntities(pts, meuse.area)
</code></pre>

<p>but also areas can indicate entities:</p>

<pre><code class="r">se.area = SpatialEntities(meuse.area, meuse.area)
</code></pre>

<h2><code>SpatialAggregation</code>: areal data</h2>

<p>Aggregations refer to values, measured or computed as the aggregate
over a set of (point) values, e.g. the mean, maximum or minimum value.
As such, aggregations need to be defined for <em>sets of points</em>, i.e.
for lines, polygons, or grid cells:</p>

<pre><code class="r">showClass(&quot;SpatialAggregation&quot;)
</code></pre>

<pre><code>## Class &quot;SpatialAggregation&quot; [package &quot;mss&quot;]
## 
## Slots:
##                    
## Name:  observations
## Class:      Spatial
</code></pre>

<p><em>Sets of points</em> can be represented by anything but points: lines, grids,
and polygons:</p>

<pre><code class="r">sa.1 = SpatialAggregation(cl)
sa.3 = SpatialAggregation(meuse.grid)
sa.2 = SpatialAggregation(pol)
</code></pre>

<h2>Three interpretations of a spatial grid</h2>

<p>Spatial grid data can be conceived as having values for
1. points, at grid cell centres
2. constant values throughout each grid cell
3. aggregated values over the grid cell region
The difference is illustrated by querying each at two points, one
coinciding with a grid cell centre, one not coinciding. The two
points are indicated by red circles:</p>

<pre><code class="r">xy = rbind(coordinates(meuse)[1,], coordinates(meuse.grid)[10,])
pts = SpatialPoints(xy, CRS(proj4string(meuse.grid)))
plot(as(meuse.grid[1:21,], &quot;SpatialPolygons&quot;))
plot(pts, col = &#39;red&#39;, pch = 16, add = TRUE)
plot(meuse.grid[1:21,], add = TRUE)
text(coordinates(pts), c(&quot;1&quot;, &quot;2&quot;), pos = 2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-16"/> </p>

<p>Querying a spatial field where cells are points gives non-missing
values only when the point coincides with the grid cell centre:</p>

<pre><code class="r">f1 = SpatialField(meuse.grid, meuse.area, cellsArePoints = TRUE)
pts = SpatialField(pts, meuse.grid)
over(pts, f1)
</code></pre>

<pre><code>##   part.a part.b      dist soil ffreq
## 1     NA     NA        NA &lt;NA&gt;  &lt;NA&gt;
## 2      1      0 0.0122243    1     1
</code></pre>

<p>Querying a spatial field where cells are constant valued areas gives
the grid cell values of the cells where the point is in:</p>

<pre><code class="r">f2 = SpatialField(meuse.grid, meuse.area, cellsArePoints = FALSE)
over(pts, f2) # matches pts to the complete grid cell
</code></pre>

<pre><code>##   part.a part.b       dist soil ffreq
## 1      1      0 0.00135803    1     1
## 2      1      0 0.01222430    1     1
</code></pre>

<p>Querying a grid where cell values are aggregations does not answer and
generates a warning:</p>

<pre><code class="r">a = SpatialAggregation(meuse.grid)
over(pts, a)
</code></pre>

<pre><code>## Warning: deriving field values from aggregations is not considered
## meaningful
</code></pre>

<pre><code>## NULL
</code></pre>

<h2>Methods for fields: interpolation</h2>

<h3>point-to-point interpolation</h3>

<p>We can predict to points, laid out regularly, inside the polygon of the field domain:</p>

<pre><code class="r">m = SpatialField(meuse, meuse.area)
v = gstat::vgm(.6, &quot;Sph&quot;, 900, .05) # variogram model
i1 = interpolate(log(zinc)~1, m, model = v)
</code></pre>

<pre><code>## [using ordinary kriging]
</code></pre>

<pre><code class="r">spplot(i1, &quot;var1.pred&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-20"/> </p>

<p>To show that these really concern points, plotting for a smaller region gives
actual point symbols:</p>

<pre><code class="r">spplot(i1[1:300,], &quot;var1.pred&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-21"/> </p>

<p>Alternatively, we can predict values on a pre-defined grid, taken
from the domain:</p>

<pre><code class="r">m = SpatialField(meuse, meuse.grid)
i2 = interpolate(log(zinc)~1, m, model = v)
</code></pre>

<pre><code>## [using ordinary kriging]
</code></pre>

<pre><code class="r">print(as(i2[1:3,], &quot;data.frame&quot;), digits = 10) # point support
</code></pre>

<pre><code>##     var1.pred     var1.var      x      y
## 1 6.501248333 0.3222480995 181180 333740
## 2 6.624055036 0.2534788321 181140 333700
## 3 6.506542742 0.2747544736 181180 333700
</code></pre>

<h3>point-to-area interpolation (block kriging)</h3>

<p>From point values, we can predict the polygon area mean value:</p>

<pre><code class="r">library(rgeos)
m3 = SpatialAggregation(meuse.area)
i3 = interpolate(log(zinc)~1, m, m3, model = v) # interpolate from point TO polygon support
</code></pre>

<pre><code>## [using ordinary kriging]
</code></pre>

<pre><code class="r">i3$var1.pred # a single value, estimate of mean for the whole area
</code></pre>

<pre><code>## [1] 5.716157
</code></pre>

<pre><code class="r">mean(log(m$zinc)) # sample mean
</code></pre>

<pre><code>## [1] 5.885776
</code></pre>

<pre><code class="r">mean(i1$var1.pred) # mean of predictions, similar to i2$var1.pred
</code></pre>

<pre><code>## [1] 5.705917
</code></pre>

<p>or predict values for grid cell averages (block kriging):</p>

<pre><code class="r">m4 = SpatialAggregation(meuse.grid)
i4 = interpolate(log(zinc)~1, m, m4, model = v) # interpolate from point TO feature (cell) support
</code></pre>

<pre><code>## [using ordinary kriging]
</code></pre>

<pre><code class="r">print(as(i4[1:3,], &quot;data.frame&quot;), digits = 10) # grid cells support
</code></pre>

<pre><code>##     var1.pred     var1.var      x      y
## 1 6.500767419 0.2521655376 181180 333740
## 2 6.623255277 0.1837112271 181140 333700
## 3 6.505998695 0.2048321051 181180 333700
</code></pre>

<pre><code class="r">spplot(i4, &quot;var1.pred&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-24"/> </p>

<h3>Support: area-to-point and area-to-area kriging</h3>

<p>Suppose we have grid data on a 3 x 3 grid, and want to estimate on a new location, indicated by a red
circle:</p>

<pre><code class="r">set.seed(131)
gt = GridTopology(cellcentre.offset = c(0,0), cellsize = c(1,1), cells.dim = c(3,3))
sgdf = SpatialGridDataFrame(SpatialGrid(gt), 
    data.frame(r = round(runif(9, max = 10), 1)))
plot(as(sgdf, &quot;SpatialPolygons&quot;), axes = TRUE)
text(coordinates(sgdf), labels = sgdf[[1]])
pt.red = SpatialPoints(cbind(0.25, 0.25))
points(pt.red, col = &#39;red&#39;, pch = 1)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-25"/> </p>

<p>The first case is when the grid cell data represent
point support values at the grid cell centre, which
is identical to case <code>i1</code> above:</p>

<pre><code class="r">sf = SpatialField(as(sgdf, &quot;SpatialPointsDataFrame&quot;), sgdf)
vm = gstat::vgm(1, &quot;Exp&quot;, 1)
i5 = interpolate(r~1, sf, SpatialField(pt.red, sgdf), model = vm)
</code></pre>

<pre><code>## [using ordinary kriging]
</code></pre>

<pre><code class="r">as(i5[1,], &quot;data.frame&quot;)
</code></pre>

<pre><code>##           coords.x1 coords.x2 var1.pred  var1.var
## coords.x1      0.25      0.25  4.741938 0.4233456
</code></pre>

<p>The second case, grid cells represent constant area with
point support value, meaning that every point location within
a grid cell has the value of the grid cell assigned:</p>

<pre><code class="r">sf = SpatialField(sgdf, sgdf, cellsArePoints = FALSE)
i6 = interpolate(r~1, sf, SpatialField(pt.red, sgdf), model = vm)
as(i6[1,], &quot;data.frame&quot;) # does not interpolate, but queries grid cell
</code></pre>

<pre><code>##     r coords.x1 coords.x2
## 1 5.2      0.25      0.25
</code></pre>

<p>as case <code>i4</code> above, from point values we can predict a mean value for a grid cell by</p>

<pre><code class="r">sf = SpatialField(sgdf, sgdf, cellsArePoints = TRUE)
gt = GridTopology(cellcentre.offset = c(.25,.25), cellsize = c(1,1), cells.dim = c(1,1))
grd.red = SpatialGrid(gt)
i7 = interpolate(r~1, sf, SpatialAggregation(grd.red), model = vm)
</code></pre>

<pre><code>## [using ordinary kriging]
</code></pre>

<pre><code class="r">i7@observations@data
</code></pre>

<pre><code>##   var1.pred  var1.var
## 1  4.609252 0.1198707
</code></pre>

<h3>Area-to-point kriging</h3>

<pre><code class="r">sp = as(sgdf, &quot;SpatialPolygonsDataFrame&quot;)
gf = SpatialAggregation(sp)
kr = interpolate(r~1, gf, SpatialField(pt.red, sp), model = vm)
kr@observations[[1]]
</code></pre>

<pre><code>## [1] 5.356593
</code></pre>

<pre><code class="r">library(gstat)
krige0(r ~ 1, sp, pt.red, vgmArea, vgm = vm) # check
</code></pre>

<pre><code>##       [,1]
## 1 5.356593
</code></pre>

<h3>Area-to-area (grid-to-grid) kriging</h3>

<pre><code class="r">sp = as(sgdf, &quot;SpatialPolygonsDataFrame&quot;)
gr = as(grd.red, &quot;SpatialPolygons&quot;)
grd = addAttrToGeom(gr, data.frame(r=0), FALSE)
plot(as(sgdf, &quot;SpatialPolygons&quot;), axes = TRUE)
text(coordinates(sgdf), labels = sgdf[[1]])
plot(grd, add = TRUE, border = &#39;red&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-30"/> </p>

<pre><code class="r">kr = interpolate(r~1, gf, SpatialAggregation(grd), model = vm)
kr@observations[[1]]
</code></pre>

<pre><code>## [1] 5.029828
</code></pre>

<pre><code class="r">krige0(r ~ 1, sp, grd, vgmArea, vgm = vm) # check
</code></pre>

<pre><code>##       [,1]
## 1 5.029828
</code></pre>

<h2>Estimating density from entitities</h2>

<p>For <code>SpatialEntity</code> objects, we can estimate the density of objects; this
method reuses <code>MASS:kde2d</code>:</p>

<pre><code class="r">e = SpatialEntities(meuse, meuse.area)
d = density(e, newdata = meuse.grid)
lt = list(list(&quot;sp.polygons&quot;, meuse.area, border = &#39;black&#39;,
    first=FALSE), list(&quot;sp.points&quot;, meuse, col = grey(.5), pch = 16))
class(d)
</code></pre>

<pre><code>## [1] &quot;SpatialAggregation&quot;
## attr(,&quot;package&quot;)
## [1] &quot;mss&quot;
</code></pre>

<pre><code class="r">spplot(d, sp.layout = lt)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-31"/> </p>

<p>The reason why this returns a <code>SpatialAggregation</code> is that the
values computed (densities) do not correspond to quantities that are
measurable at point locations where they are registered (grid cells).
In fact, they are aggregated values for areas even much larger than
the grid cells.</p>

<h2>Spatial Aggregation</h2>

<h3>for <code>SpatialField</code> data</h3>

<pre><code class="r">m = SpatialField(meuse[&quot;zinc&quot;], meuse.area)
a = aggregate(m, SpatialAggregation(meuse.area), mean) # no warning
a[[1]]
</code></pre>

<pre><code>## [1] 469.7161
</code></pre>

<pre><code class="r">a = aggregate(m, SpatialAggregation(meuse.area), sum) # warns:
</code></pre>

<pre><code>## Warning: for SpatialField objects, aggregation using a sum function is not
## considered meaningful
</code></pre>

<pre><code class="r">a[[1]]
</code></pre>

<pre><code>## [1] 72806
</code></pre>

<h3>for <code>SpatialEntity</code> data</h3>

<pre><code class="r">m = SpatialEntities(meuse[&quot;zinc&quot;], meuse.area)
a = aggregate(m, SpatialAggregation(meuse.area), mean) # warns:
</code></pre>

<pre><code>## Warning: aggregation using a non-sum function may not be meaningful
</code></pre>

<pre><code class="r">a[[1]]
</code></pre>

<pre><code>## [1] 469.7161
</code></pre>

<pre><code class="r">a = aggregate(m, SpatialAggregation(meuse.area), sum) # no warning
a[[1]]
</code></pre>

<pre><code>## [1] 72806
</code></pre>

<h1>Meaningful warnings</h1>

<p>Pebesma et al. (<a href="https://agu.confex.com/agu/fm14/meetingapp.cgi#Paper/3289">2014</a>)
make assertions A1-A7. </p>

<h2>A1.</h2>

<p><strong>A prediction is meaningful, if it provides an estimate for a potential observation
Prediction on a field variable generates no warning.</strong></p>

<p>Where prediction of a <code>SpatialField</code> varialbe generates no warning,</p>

<pre><code class="r">m = SpatialField(meuse, meuse.area) # data are point support
res = interpolate(log(zinc)~1, m) # interpolate from point TO point support
</code></pre>

<pre><code>## [inverse distance weighted interpolation]
</code></pre>

<p>prediction of a point pattern variable generates a warning:</p>

<pre><code class="r">m = SpatialEntities(meuse, meuse.area)
sa = SpatialAggregation(meuse.grid)
res = interpolate(log(zinc)~1, m, sa) # interpolate point pattern variable: warns
</code></pre>

<pre><code>## Warning: interpolation of SpatialEntities is not considered meaningful
</code></pre>

<h2>A2.</h2>

<p><strong>Summing up values over an area is meaningful, if the observed window corresponds to the target geometry (grouping predicate) of the aggregation.</strong></p>

<p>For <code>SpatialEntity</code> data, spatial aggregation over an area larger than the 
observation window generates a warning:</p>

<pre><code class="r">x = bbox(meuse)[1,]
y = bbox(meuse)[2,]
bb = Polygon(cbind(c(x[1],x[1],x[2],x[2],x[1]), c(y[1],y[2],y[2],y[1],y[1])))
bbx = SpatialPolygons(list(Polygons(list(bb),&quot;bbox_meuse&quot;)),
    proj4string = CRS(proj4string(meuse)))
m = SpatialEntities(meuse[&quot;zinc&quot;], meuse.area)
a = aggregate(m, SpatialAggregation(bbx), sum) # warns:
</code></pre>

<pre><code>## Warning: aggregation over an area larger than the observation window is not
## considered meaningful
</code></pre>

<p>Stasch et al. <a href="http://www.sciencedirect.com/science/article/pii/S1364815213001977">2014</a>
prove A1 and A2 more formally.</p>

<p>Further assertions in the poster:</p>

<h2>A3.</h2>

<p><strong>Polygon data may reflect constant values over areas (geology) or means 
(population density), this matters for (further) aggregation or downsampling.</strong></p>

<p>Package <code>mss</code> distinguishes between <code>SpatialField</code> and
<code>SpatialAggregation</code> to represent constant values, and aggregations,
respectively. Subsampling <code>SpatialField</code> variabls does not not warn,</p>

<pre><code class="r">area = addAttrToGeom(meuse.area, data.frame(v=1), match.ID = FALSE)
f = SpatialField(area, meuse.area)
pts = SpatialField(meuse[1:5,], meuse.area)
over(pts, f) # retrieve f at the points of pts:
</code></pre>

<pre><code>##   v
## 1 1
## 2 1
## 3 1
## 4 1
## 5 1
</code></pre>

<p>but subsampling <code>SpatialAggregation</code> variables triggers a warning, and no
useful value</p>

<pre><code class="r">a = SpatialAggregation(area)
over(pts, a)
</code></pre>

<pre><code>## Warning: deriving field values from aggregations is not considered
## meaningful
</code></pre>

<pre><code>## NULL
</code></pre>

<p>as it should really disaggregate first, from area to point.</p>

<h2>A4.</h2>

<p><strong>The same is true for grid cells.</strong></p>

<p><code>SpatialField</code> and <code>SpatialAggregation</code> both generalize polygon and grid data.</p>

<pre><code class="r">f1 = SpatialField(meuse.grid, meuse.area, cellsArePoints = TRUE)
pts = SpatialField(meuse[1:5,], meuse.area)
over(pts, f1) # matches pts to grid cell center points:
</code></pre>

<pre><code>##   part.a part.b dist soil ffreq
## 1     NA     NA   NA &lt;NA&gt;  &lt;NA&gt;
## 2     NA     NA   NA &lt;NA&gt;  &lt;NA&gt;
## 3     NA     NA   NA &lt;NA&gt;  &lt;NA&gt;
## 4     NA     NA   NA &lt;NA&gt;  &lt;NA&gt;
## 5     NA     NA   NA &lt;NA&gt;  &lt;NA&gt;
</code></pre>

<pre><code class="r">f2 = SpatialField(meuse.grid, meuse.area, cellsArePoints = FALSE)
over(pts, f2) # matches pts to the complete grid cell
</code></pre>

<pre><code>##   part.a part.b       dist soil ffreq
## 1      1      0 0.00135803    1     1
## 2      1      0 0.01222430    1     1
## 3      1      0 0.10302900    1     1
## 4      1      0 0.19009400    2     1
## 5      1      0 0.27709000    2     1
</code></pre>

<pre><code class="r">a = SpatialAggregation(meuse.grid)
over(pts, a)
</code></pre>

<pre><code>## Warning: deriving field values from aggregations is not considered
## meaningful
</code></pre>

<pre><code>## NULL
</code></pre>

<h2>A5.</h2>

<p><strong>Point pattern data often come without observation window, over which aggregation is meaningful</strong></p>

<p>Attempting to create a <code>SpatialEntities</code> object without an observation window specified gives
a warning message:</p>

<pre><code class="r">pts &lt;- SpatialEntities(meuse)
</code></pre>

<pre><code>## Warning: window set to the observation data features
</code></pre>

<p>Providing a window that does not contain all the points gives an error:</p>

<pre><code class="r">tr = try(pts &lt;- SpatialEntities(meuse, meuse[1:10,]))
attr(tr, &quot;condition&quot;)
</code></pre>

<pre><code>## &lt;simpleError in validityMethod(object): one or more features are outside the observation window&gt;
</code></pre>

<h2>A6.</h2>

<p><strong>Field measurements often come without a notion for which locations interpolations based on them make sense.</strong></p>

<pre><code class="r">m = SpatialField(meuse[&quot;zinc&quot;], meuse.area)
a = interpolate(log(zinc)~1, m, SpatialAggregation(bbx)) # warns:
</code></pre>

<pre><code>## Warning: interpolating over an area larger than the domain is not
## considered meaningful
</code></pre>

<pre><code>## [inverse distance weighted interpolation]
</code></pre>

<h2>A7.</h2>

<p><strong>File types do not inform on meaningfulness</strong></p>

<p><code>SpatialPoints</code>, <code>SpatialPixels</code>, <code>SpatialGrid</code>, <code>SpatialLines</code>,
<code>SpatialPolygons</code> and their <code>*DataFrame</code> counterparts do not inform
whether data concern fields (geostatistical data), entities (point
patterns), or aggregations. The classes in <code>mss</code>: <code>SpatialField</code>,
<code>SpatialEntities</code>, and <code>SpatialAggregation</code>, do.</p>

<h2>References</h2>

<ol>
<li>E. Pebesma, C. Stasch, B. Graeler and S. Scheider, 2014.  Meaningfully Integrating Big Earth Science Data; AGU fall meeting, poster <a href="https://agu.confex.com/agu/fm14/meetingapp.cgi#Paper/3289">IN33A-3757</a> <a href="https://agu.confex.com/data/handout/agu/fm14/Paper_3289_handout_1504_0.pdf">pdf</a></li>
<li>Stasch, C., S. Scheider, E. Pebesma, W. Kuhn, 2014.  Meaningful Spatial Prediction and Aggregation.  Environmental Modelling &amp; Software, 51, 149-165 <a href="http://www.sciencedirect.com/science/article/pii/S1364815213001977">open access</a>.</li>
</ol>

</body>

</html>
